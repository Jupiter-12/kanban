# 看板系统圆桌讨论 - 会议摘要

> **生成时间**：2024年1月
> **讨论状态**：✅ 已完成
> **最终确认**：待用户批准闭环

---

## 一、项目概述

| 项目 | 内容 |
|------|------|
| **产品名称** | 看板系统 |
| **核心价值** | 让工作可见——通过可视化方式跟踪项目进度 |
| **目标用户** | 大型组织（50+人） |
| **核心场景** | 任务管理、进度跟踪、团队协作 |
| **产品形态** | Web端优先（私有化部署） |

---

## 二、讨论阶段回顾

| 阶段 | 内容 | 状态 |
|------|------|------|
| 阶段0 | 解析建库与启动 | ✅ 完成 |
| 第一阶段 | 议题解读 | ✅ 完成 |
| 第二阶段 | 多轮评审（5个子主题） | ✅ 完成 |
| 第三阶段 | 逐一决策（11项） | ✅ 完成 |
| 第四阶段 | 总结闭环 | ✅ 完成 |

---

## 三、MVP功能范围

### 3.1 核心功能

| 功能模块 | 具体功能 | 优先级 |
|----------|----------|--------|
| **任务卡片** | 标题（必填）、负责人（必填）、截止日期、优先级、标签、描述、附件 | MVP |
| **阻塞机制** | 是否阻塞开关、阻塞原因（预设+自定义）、阻塞时间记录 | MVP |
| **阻塞可视化** | 红色左边框 + 🚫图标 + hover弹窗显示原因 | MVP |
| **状态列** | 预设模板（待办→进行中→已完成）+ 可自定义扩展，上限7列 | MVP |
| **泳道分组** | 支持按负责人分组显示（简化版） | MVP |
| **拖拽流转** | 自由拖拽改变状态，默认无需审批，实时同步 | MVP |
| **任务移交** | 移交需对方确认，含原因说明 + 接受/拒绝机制 | MVP |
| **软删除** | 默认保留90天，普通成员7天内可恢复，管理员90天内可恢复 | MVP |
| **自定义字段** | 采用PostgreSQL JSONB方案，支持灵活扩展 | MVP |

### 3.2 协作与权限

| 功能模块 | 具体功能 | 优先级 |
|----------|----------|--------|
| **权限模型** | RBAC+（角色 + 数据范围） | MVP |
| **角色设计** | 系统管理员、组织管理员、项目管理员、普通成员、访客 | MVP |
| **默认权限** | 我参与的=完全权限，同部门=只读，其他部门=不可见，敏感项目=完全隐藏 | MVP |
| **权限继承** | 默认继承，敏感项目可打破继承 | MVP |
| **权限申请** | 无权限页面一键申请，分级（查看/编辑），简单审批（站内通知+一键批准/拒绝） | MVP |
| **临时授权** | 支持设置有效期，到期自动收回 | MVP |
| **审计日志** | 分层开放（管理员看全部，普通用户看自己），保留期1-3年 | MVP |
| **登录方式** | 用户名密码登录 | MVP |
| **SSO单点登录** | 企业微信 + 钉钉 + LDAP | ⏸️ 二期 |

### 3.3 视图与信息架构

| 功能模块 | 具体功能 | 优先级 |
|----------|----------|--------|
| **核心视图** | 看板视图、列表视图 | MVP |
| **我的工作台** | 今日待办、被阻塞、我关注的更新、我指派的任务 | MVP |
| **逾期显示** | 分级显示（1-3天黄色/4-7天红色/>7天严重警告），逾期任务置顶 | MVP |
| **侧边抽屉** | 点击任务卡片在侧边抽屉快速查看/编辑，不跳转页面 | MVP |
| **筛选器** | 多条件筛选、包含/排除筛选、空值筛选（无负责人等）、保存筛选器 | MVP |
| **多看板管理** | 项目看板/团队看板/个人看板/跨项目看板，任务主归属+引用机制 | MVP |
| **侧边栏** | 按收藏/我的/部门分组，支持折叠，显示数量 | MVP |
| **最近访问** | 顶部导航快捷入口，服务端存储，30天自动清理 | MVP |
| **视图切换** | 我参与的/我部门的/全公司/收藏的，默认"我参与的" | MVP |
| **快捷键** | Ctrl+K 全局搜索，Ctrl+1~9 快速切换收藏看板 | MVP |
| **日历视图** | 按截止日期展示任务 | ⏸️ 二期 |
| **甘特图** | 时间线 + 任务依赖关系 | ⏸️ 三期 |

### 3.4 通知系统

| 功能模块 | 具体功能 | 优先级 |
|----------|----------|--------|
| **通知渠道** | 站内通知（WebSocket实时）、邮件通知（异步队列） | MVP |
| **通知偏好** | 通知类型开关（任务分配/评论/关注更新等）、通知方式选择（站内/邮件） | MVP |
| **通知合并** | 智能合并同类通知（5-10分钟窗口），减少打扰 | MVP |
| **逾期通知** | 定时任务每天9点执行，分级通知（逾期天数→通知对象），可配置 | MVP |
| **IM推送** | 企业微信/钉钉消息推送 | ⏸️ 二期 |

### 3.5 进度追踪与报表

| 功能模块 | 具体功能 | 优先级 |
|----------|----------|--------|
| **个人统计** | 完成任务数、进行中、逾期数、平均周期时间、完成趋势图 | MVP |
| **项目仪表盘** | 任务概览（各状态数量）、成员负载分布、异常预警（阻塞/逾期/负载过高） | MVP |
| **管理仪表盘** | 全局指标（完成率/吞吐量/周期时间/阻塞率）、项目进度对比 | MVP |
| **数据计算** | 实时查询（简单统计）+ 定时聚合（复杂统计）+ 历史预计算（大跨度） | MVP |
| **不显示排名** | 避免内卷，不显示个人排名和工时统计 | MVP |
| **在线查看** | 统计报表在线查看 | MVP |
| **燃尽图** | 剩余工作量趋势图 | ⏸️ 二期 |
| **报表导出** | 导出为PDF/图片/Markdown，支持公司Logo | ⏸️ 二期 |
| **报表订阅** | 定时自动发送报表 | ⏸️ 二期 |

### 3.6 技术架构

| 技术层面 | 方案 | 说明 |
|----------|------|------|
| **整体架构** | 模块化单体 | 渐进式演进到微服务 |
| **前端框架** | React + TypeScript + Ant Design | 组件化开发，类型安全 |
| **后端框架** | NestJS (Node.js + TypeScript) | 开发效率高，前后端统一 |
| **数据库** | PostgreSQL | 支持JSONB，性能优秀 |
| **缓存** | Redis | 会话、热点数据、消息队列 |
| **实时通信** | WebSocket (Socket.io) | 心跳检测 + 自动重连 + 消息补发 |
| **消息队列** | RabbitMQ | 异步通知、任务队列 |
| **部署方式** | Docker Compose | 私有化部署，支持后续迁移到K8s |

### 3.7 非功能性要求

| 指标 | 目标值 | 说明 |
|------|--------|------|
| **可用性** | 99.9% | 年停机时间 < 8.76小时 |
| **页面加载** | < 2秒 | P95，100张卡片看板 |
| **拖拽响应** | < 500ms | 实时反馈 |
| **并发支持** | 50+ 用户 | 同时在线操作 |
| **WebSocket延迟** | < 1秒 | 消息推送延迟 |
| **数据安全** | HTTPS + 密码加密 | bcrypt加密存储 |
| **操作日志** | 完整记录 | 支持审计追溯 |
| **故障恢复** | RTO < 4小时 | 恢复时间目标 |
| **数据恢复点** | RPO < 1小时 | 数据备份频率 |

---

## 四、决策事项汇总

| 序号 | 决策事项 | 最终决策 | 来源 |
|------|----------|----------|------|
| 1 | 软删除数据保留策略 | ✅ 默认90天，分层恢复权限 | 子主题1 |
| 2 | 通知偏好设置是否纳入MVP | ✅ 纳入MVP（基础版：类型开关+方式选择） | 子主题1 |
| 3 | 泳道分组是否为核心功能 | ✅ 简化版纳入MVP（仅按负责人分组） | 子主题1 |
| 4 | SSO集成优先级 | ⏸️ MVP不做，二期迭代 | 子主题2 |
| 5 | 权限审批对接外部系统 | ✅ MVP简单审批，不对接外部系统 | 子主题2 |
| 6 | 甘特图是否纳入路线图 | ✅ 纳入路线图，三期实现 | 子主题3 |
| 7 | 隐私设置模块范围 | ⏸️ MVP暂不做 | 子主题3 |
| 8 | 后端技术栈选型 | ✅ **NestJS (Node.js + TypeScript)** | 子主题4 |
| 9 | 离线支持是否纳入路线图 | ❌ 暂不纳入路线图 | 子主题4 |
| 10 | 燃尽图是否为MVP必备 | ⏸️ 二期迭代，MVP不做 | 子主题5 |
| 11 | 报表生成服务部署方式 | ⏸️ MVP不做报表导出功能 | 子主题5 |

---

## 五、产品路线图

### MVP（首期）
- 核心看板功能（任务卡片、状态列、拖拽流转、泳道分组）
- 协作与权限（RBAC+权限模型、简单审批、用户名密码登录）
- 视图与信息架构（看板视图、列表视图、我的工作台、筛选器）
- 通知系统（站内通知、邮件通知、通知偏好设置）
- 基础报表（个人统计、项目仪表盘、管理仪表盘，仅在线查看）
- 技术架构（NestJS + PostgreSQL + Redis + WebSocket）
- 私有化部署（Docker Compose）

### 二期
- SSO单点登录（企业微信 + 钉钉 + LDAP）
- 日历视图
- 燃尽图
- 报表导出（PDF/图片/Markdown）
- 报表订阅（定时发送）
- IM通知推送（企业微信/钉钉）
- 隐私设置模块
- 对接外部审批系统

### 三期
- 甘特图（时间线 + 依赖关系）
- 自定义报表
- 高级自动化工作流
- 移动端适配
- 其他根据用户反馈确定

### 暂不规划
- 离线支持（根据用户反馈再评估）

---

## 六、MVP工作量评估

### 6.1 功能模块工作量

| 模块 | 预估工作量 |
|------|------------|
| 核心功能（任务卡片、状态列、拖拽、泳道分组） | 20人天 |
| 协作与权限（权限模型、审批、登录） | 15人天 |
| 视图与信息架构（工作台、筛选器、多看板） | 18人天 |
| 通知系统（站内通知、邮件、偏好设置） | 10人天 |
| 进度追踪与报表（统计、仪表盘） | 12人天 |
| 技术基础设施（架构、数据库、WebSocket） | 15人天 |
| 测试与部署 | 12人天 |
| **合计** | **约102人天** |

### 6.2 决策调整影响

| 调整项 | 工作量变化 |
|--------|------------|
| ➕ 通知偏好设置（基础版） | +5人天 |
| ➕ 泳道分组（简化版） | +3人天 |
| ➖ SSO集成 | -8人天 |
| ➖ 隐私设置模块 | -1人天 |
| ➖ 燃尽图 | -4人天 |
| ➖ 报表导出功能 | -3人天 |
| **净变化** | **-8人天** |

### 6.3 最终评估

| 项目 | 数值 |
|------|------|
| 基础工作量 | 102人天 |
| 决策调整 | -8人天 |
| **MVP总工作量** | **约94人天** |
| 建议周期 | 8-10周（4-5人团队） |

---

## 七、风险提示与应对

| 风险项 | 风险等级 | 影响 | 应对措施 |
|--------|----------|------|----------|
| MVP无SSO，推广可能有阻力 | 🟡 中 | 用户需记忆新密码 | 二期优先补充，内部试点先行，IT批量创建账号 |
| 无报表导出，汇报场景受限 | 🟢 低 | 无法直接发送报表 | 可截图或复制数据，二期补充 |
| NestJS招聘有一定挑战 | 🟡 中 | 团队扩张可能受限 | 招聘放宽到TypeScript/Node.js经验，前端可培训转型 |
| 实时协作冲突 | 🟢 低 | 多人同时操作可能冲突 | 乐观锁+冲突提示+操作日志 |
| 私有化部署环境差异 | 🟡 中 | 客户环境可能不一致 | 完善部署文档，提供多种部署方案 |

---

## 八、验收标准

### 8.1 功能验收

- [ ] 所有MVP功能点可正常使用
- [ ] 核心流程（创建任务→拖拽→完成）无阻塞
- [ ] 权限控制符合设计（越权测试通过）
- [ ] 通知功能正常触发和送达

### 8.2 性能验收

- [ ] 页面加载时间 < 2秒（100张卡片看板）
- [ ] 拖拽操作响应 < 500ms
- [ ] 50并发用户无报错
- [ ] WebSocket消息延迟 < 1秒

### 8.3 安全验收

- [ ] HTTPS配置正确
- [ ] 密码加密存储
- [ ] 权限越权测试0通过
- [ ] 操作日志完整记录

### 8.4 部署验收

- [ ] Docker Compose一键部署成功
- [ ] 备份恢复演练通过
- [ ] 监控告警配置完成

---

## 九、交付物清单

| 交付物 | 说明 | 状态 |
|--------|------|------|
| 产品需求文档 | 基于本次讨论整理 | 待整理 |
| 技术架构文档 | NestJS + PostgreSQL + Redis | 待整理 |
| 数据库设计文档 | 表结构、索引、JSONB字段 | 待整理 |
| API接口文档 | RESTful API + WebSocket事件 | 待整理 |
| 部署手册 | Docker Compose私有化部署 | 待整理 |
| 测试用例 | 功能、性能、安全测试用例 | 待整理 |

---

## 十、参会专家确认

| 角色 | 确认状态 | 意见 |
|------|----------|------|
| 产品经理 | ✅ 已确认 | 无异议 |
| 用户代表 | ✅ 已确认 | 无异议，期待尽快上线 |
| 用户体验设计师 | ✅ 已确认 | 建议收集上线后用户反馈 |
| 技术负责人 | ✅ 已确认 | 建议MVP前进行压力测试 |
| 运维工程师 | ✅ 已确认 | 将准备部署手册和监控模板 |
| 测试工程师 | ✅ 已确认 | 建议进行UAT用户验收测试 |

---

## 附录：关键讨论楼层索引

| 主题 | 关键楼层 |
|------|----------|
| 议题解读 | #2-#7 |
| 核心功能设计 | #10-#19 |
| 协作与权限体系 | #22-#33 |
| 视图与信息架构 | #36-#54 |
| 技术架构与部署 | #57-#69 |
| 进度追踪与报表 | #72-#84 |
| 决策事项讨论 | #87-#155, #169-#175 |
| 结论草案 | #159 |
| 专家确认 | #160-#164 |
| 决策8重新讨论 | #169-#176 |

---

**文档版本**：v1.1
**最后更新**：决策事项8重新确认为NestJS
