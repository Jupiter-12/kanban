# 看板系统圆桌讨论完整记录

> 📅 讨论日期：2024年1月
> 👥 参与角色：产品经理、用户代表、用户体验设计师、技术负责人、运维工程师、测试工程师
> 🎯 评审议题：看板系统来跟踪项目进度
> 🏢 目标用户：大型组织（50+人）

---

## 阶段0：解析建库与启动

### 【会议裁判】#1 议题解析

收到评审议题："我需要一个看板系统来跟踪项目进度"

**议题解析：**
- 核心需求：看板系统（Kanban Board）
- 主要目标：项目进度跟踪与可视化管理
- 潜在用户：项目团队成员、管理者

**确认的讨论范围：**
1. 核心功能：任务卡片管理、状态列（泳道）、拖拽流转、任务详情
2. 协作能力：多人协作、任务分配、评论通知、权限控制
3. 视图与筛选：看板视图、列表视图、筛选/搜索、标签分类
4. 进度追踪：截止日期、进度统计、报表/仪表盘
5. 技术形态：Web端优先
6. 集成扩展：与现有系统集成

**大型组织特殊考量：** 权限体系复杂度、多部门/多项目隔离、审计日志、SSO单点登录、高并发性能

**用户确认：** ✅ 范围合适，目标规模为大型组织（50+人）

---

## 第一阶段：议题解读

### 【会议裁判】#1 开场

各位专家好，欢迎参加本次看板系统评审圆桌讨论。议题：为大型组织（50+人）设计一个看板系统来跟踪项目进度。

---

### 【产品经理】#2 产品视角解读

**核心价值定位：** 看板系统的本质是"让工作可见"——通过可视化的方式，让团队成员和管理者都能快速了解"谁在做什么、做到哪了、有什么阻塞"。

**大型组织的特殊挑战：**
1. **信息过载**：50+人意味着可能有数百甚至上千张任务卡片同时存在，如何避免看板变成"垃圾场"？
2. **跨部门协作**：任务往往需要跨团队流转，如何处理"我的任务依赖别人"的场景？
3. **管理层视角**：高层需要看全局进度，一线需要看具体任务，视图层次如何设计？

**初步疑问：**
- 我们是要做一个"通用看板"还是针对特定场景（如研发、市场、HR）的"专用看板"？
- 是否需要支持多种工作流方法论（Kanban、Scrum、瀑布）？

---

### 【用户代表】#3 一线用户视角

**日常使用场景：** 作为大型组织的普通员工，我每天打开看板系统最想知道的就三件事：
1. **今天我该干什么？**（我的任务清单）
2. **有没有人在等我？**（被阻塞的下游任务）
3. **我等的东西好了没？**（我依赖的上游任务）

**现有工具的痛点：**
- 很多看板系统功能强大，但找到"我的任务"要点好几下，太慢了
- 通知太多变成噪音，通知太少又怕漏事，通知粒度很难调
- 跨部门任务经常"石沉大海"，不知道对方看没看、接没接

**情感诉求：** 说实话，大家对又上一个新系统是有抵触的。如果这个看板用起来比Excel还麻烦，推广会很难。**简单、快、少点击**是我最大的期望。

---

### 【用户体验设计师】#4 交互设计视角

**设计理念：渐进式披露（Progressive Disclosure）** ——不是砍功能，而是在对的时机展示对的功能。

**具体策略：**
1. **首屏即答案**：用户打开看板，首屏直接回答"今天干什么"——设计一个"我的工作台"作为默认首页
2. **三层信息架构**：
   - 第一层：卡片标题+状态+负责人（一眼扫过）
   - 第二层：点击展开摘要、截止日、标签（快速了解）
   - 第三层：进入详情页看完整信息（深度操作）
3. **智能默认值**：新建任务时，自动填充当前泳道、当前用户、默认截止日

**关于"通用vs专用"：** 建议底层通用+模板专用——提供研发、市场、HR等场景模板，但底层是同一套组件。

---

### 【技术负责人】#5 技术架构视角

**技术架构初步构想：**

| 层面 | 方案 | 考量 |
|------|------|------|
| 实时同步 | WebSocket + CRDT/OT算法 | 解决并发冲突，保证最终一致性 |
| 后端架构 | 微服务 + 消息队列 | 大型组织需要高可用、可扩展 |
| 数据库 | PostgreSQL主库 + Redis缓存 | 关系型保证事务，缓存提升性能 |
| 前端框架 | React/Vue + 状态管理 | 组件化开发，便于维护 |

**拖拽冲突处理方案：**
1. 乐观更新+冲突检测：用户拖拽时立即显示结果，后端检测到冲突时回滚并提示
2. 操作锁定（可选）：正在被拖拽的卡片显示"某某正在操作"
3. 操作日志：所有变更记录可追溯，支持撤销

**大型组织特殊技术需求：**
- SSO集成：对接企业AD/LDAP或OAuth2.0
- 审计日志：谁在什么时间做了什么操作，必须完整记录
- 多租户隔离：多个部门/子公司，数据需要严格隔离

---

### 【运维工程师】#6 运维部署视角

**部署方案建议：**

| 方案 | 优点 | 缺点 | 适用场景 |
|------|------|------|----------|
| 公有云SaaS | 零运维、弹性扩展 | 数据在外部 | 快速验证 |
| 私有化部署 | 数据自主、深度定制 | 运维成本高 | 数据敏感 |
| 混合云 | 兼顾安全与弹性 | 架构复杂 | 大型组织 |

**倾向：** 大型组织通常对数据安全敏感，建议优先考虑私有化部署或混合云。

**运维关注点：**
1. 监控告警：系统健康度、接口响应时间、错误率
2. 备份恢复：数据库定时备份、灾难恢复演练
3. 灰度发布：新版本先小范围验证，再全量推送
4. 容量规划：50人→500人，数据库、缓存、带宽都要能扛住

---

### 【测试工程师】#7 测试策略视角

**测试策略框架：**

| 测试类型 | 重点内容 | 工具建议 |
|----------|----------|----------|
| 功能测试 | 任务CRUD、拖拽流转、权限校验 | Selenium/Cypress |
| 性能测试 | 50-500并发用户、大数据量看板加载 | JMeter/k6 |
| 安全测试 | 越权访问、XSS/CSRF、数据泄露 | OWASP ZAP |
| 兼容性测试 | 主流浏览器、不同分辨率 | BrowserStack |
| 回归测试 | 核心流程自动化 | CI/CD集成 |

**大型组织特殊测试场景：**
1. 权限矩阵测试：管理员、部门经理、普通成员、访客
2. 跨部门流转测试：任务从A部门流转到B部门，权限怎么变化
3. 并发冲突测试：模拟多人同时拖拽同一张卡片
4. 数据隔离测试：A部门绝对不能看到B部门的数据

**验收标准建议：**
- 页面加载时间 < 2秒（100张卡片看板）
- 拖拽操作响应 < 200ms
- 50并发用户无报错

---

### 【会议裁判】#8 第一阶段总结

**初步共识：**
1. 核心价值：让工作可见，快速回答"谁在做什么、做到哪了"
2. 用户体验优先：简单易用是推广成功的关键，"首屏即答案"
3. 大型组织必备：SSO、权限体系、审计日志、数据隔离
4. 技术架构：需支持高并发、实时协作、可扩展
5. 部署方式：倾向私有化部署或混合云
6. 测试策略：需覆盖功能、性能、安全、权限矩阵

**待澄清问题：**
1. 通用看板 vs 专用场景看板？
2. 是否支持多种方法论（Kanban/Scrum/瀑布）？
3. 具体需要对接哪些外部系统？
4. 移动端是否为必需？

**用户确认：** ✅ 确认进入第二阶段

---

## 第二阶段：多轮评审

### 子主题1：核心功能设计（#9-#20楼）

#### 【会议裁判】#9 开题
讨论范围：任务卡片、状态列（泳道）、拖拽流转、任务详情

#### 【产品经理】#10 核心功能框架
**任务卡片字段设计**：
| 字段 | 必填/选填 | 说明 |
|------|-----------|------|
| 标题 | ✅ 必填 | 一句话描述任务 |
| 负责人 | ✅ 必填 | 谁来做 |
| 状态 | ✅ 系统自动 | 由所在泳道决定 |
| 截止日期 | ⚪ 选填 | 但强烈建议填写 |
| 优先级 | ⚪ 选填 | 高/中/低/紧急 |
| 标签 | ⚪ 选填 | 多标签分类 |
| 描述 | ⚪ 选填 | 详细说明 |
| 附件 | ⚪ 选填 | 支持文件上传 |

**状态列设计**：预设+自定义结合，列数上限7列

**流转审批问题**：提出自由流转vs受控流转两种模式

#### 【用户代表】#11 回复 #10
**强烈反对繁琐审批**：
- 现有系统审批流程导致任务状态更新延迟
- 建议日常任务自由流转，只在关键节点加审批
- **新增需求**：增加"阻塞原因"字段

#### 【用户体验设计师】#12 回复 #11
**阻塞状态可视化方案**：
| 方案 | 视觉表现 | 评价 |
|------|----------|------|
| A. 独立泳道 | 单独一列"已阻塞" | 增加列数 |
| B. 卡片标记 | 红色边框+🚫图标 | ✅ 推荐 |
| C. 浮层提示 | 悬停显示原因 | ✅ 推荐 |

**最终推荐**：B+C组合方案

**提出泳道分组概念**：横向状态流转 + 纵向按负责人/优先级分组

#### 【技术负责人】#14 回复 #12
**自定义字段技术方案**：
- 推荐方案B（JSONB）：PostgreSQL的JSONB类型存自定义字段
- 性能评估：10万条数据，JSONB+GIN索引，查询性能可接受
- 建议"阻塞原因"作为系统预设的可选字段

#### 【产品经理】#15 回复 #11
**更新字段设计**，接受阻塞原因需求：
| 字段 | 类型 | 说明 |
|------|------|------|
| 是否阻塞 | 布尔 | 开关标记 |
| 阻塞原因 | 枚举+自定义 | 预设：等待他人/缺少资源/需求不清/外部依赖/其他 |
| 阻塞时间 | 时间戳 | 系统自动记录 |

**审批策略修正**：
- 普通任务状态变更：无需审批
- 任务删除：可配置
- 跨部门任务移交：可配置需对方确认
- 关键里程碑完成：可配置

#### 【用户代表】#16 回复 #15
接受折中方案，补充任务移交需求：
- 需要看到谁移交的、为什么移交
- 需要一键"接受"或"拒绝并说明原因"

#### 【测试工程师】#17 回复 #14
**自定义字段测试策略**：
- 测试维度：字段类型、边界值、CRUD操作、数据迁移、查询性能、索引有效性
- 追问：软删除数据保留多久？谁有权恢复？

#### 【用户体验设计师】#18 回复 #16
**任务移交交互流程设计**：
- 发起方：选择移交人+移交原因（预设+自定义）
- 接收方：查看任务详情+接受/拒绝按钮
- 拒绝需填写原因，通知发起方

#### 【运维工程师】#19 回复 #18
**通知系统技术方案**：
- 架构：用户操作→消息队列→通知服务→站内/邮件/IM
- 延迟预期：站内<1秒，邮件1-5分钟，IM 1-3秒
- 建议增加通知偏好设置

#### 【会议裁判】#20 子主题1小结
**已形成共识**：
1. 卡片必填字段：标题、负责人
2. 阻塞机制：是否阻塞+阻塞原因字段
3. 阻塞可视化：B+C方案（红色边框+图标+hover弹窗）
4. 状态列：预设模板+可自定义，上限7列
5. 流转审批：默认自由流转，特定场景可配置
6. 任务移交：需对方确认
7. 自定义字段：JSONB方案
8. 通知系统：站内实时+邮件异步+IM推送

**待决事项**：软删除保留策略、通知偏好是否MVP、泳道分组是否核心功能

---

### 子主题2：协作与权限体系（#21-#34楼）

#### 【会议裁判】#21 开题
讨论范围：权限模型、组织架构、数据隔离、协作机制、SSO集成

#### 【技术负责人】#22 权限模型方案
**权限模型选型**：
| 模型 | 原理 | 适用场景 |
|------|------|----------|
| RBAC | 用户→角色→权限 | 中小型组织 |
| ABAC | 基于属性动态计算 | 超大型/复杂场景 |
| **RBAC+** | RBAC+数据范围 | ✅ 大型组织推荐 |

**角色设计**：系统管理员、组织管理员、项目管理员、普通成员、访客

**数据隔离**：每条数据带org_id、dept_id、project_id标识

#### 【产品经理】#23 回复 #22
**典型权限场景**：
- 跨部门项目：两部门成员都能看
- 领导巡视：只读权限，全公司范围
- 外包协作：只能看分配给他的任务
- 临时支援：临时权限，到期自动收回
- 敏感项目：打破继承，仅成员可见

**权限继承**：默认继承，敏感项目可打破继承

**临时授权**：支持有效期+授权审批+授权日志

#### 【用户代表】#24 回复 #23
**权限痛点**：
- 太严：申请权限等两天，事情早过了
- 太松：信息过载，找自己任务像大海捞针

**期望**：智能默认+快速申请
- 我参与的项目：完全权限
- 我部门的项目：默认可见（只读）
- 其他部门：默认不可见，能搜到存在

#### 【用户体验设计师】#25 回复 #24
**无权限页面设计**：
- 告知这是什么、谁负责
- 提供一键申请入口
- 分级申请（查看/编辑）
- 预期管理（通常1小时内处理）

#### 【技术负责人】#26 回复 #25
**权限审批技术方案**：
- 推荐：方案A简单审批（MVP）+ 方案C对接外部（后续）
- 数据模型：permission_requests表
- 临时授权：expires_at字段，定时任务扫描过期权限

#### 【测试工程师】#27 回复 #26
**权限测试策略**：
- 测试矩阵：角色×数据范围×操作类型
- 关键场景：越权访问、权限继承、打破继承、临时授权、权限申请、权限回收
- 安全测试：水平越权、垂直越权、权限绕过

#### 【运维工程师】#28 回复 #27
**审计日志方案**：
- 记录内容：登录日志、权限变更、敏感操作、数据访问
- 保留期：登录1年、权限变更3年、敏感操作3年、普通操作3个月
- 存储：实时→Kafka→ES热数据→冷存储归档

#### 【产品经理】#29 回复 #28
**审计日志可见性**：
- 系统管理员：全部日志
- 部门管理员：本部门成员操作
- 项目管理员：本项目操作
- 普通成员：仅自己的操作记录

#### 【会议裁判】#30 促进对话
指出权限默认边界需要 @产品经理 和 @用户代表 对齐

#### 【产品经理】#31 回复 #30
**默认权限方案**：
| 数据范围 | 默认权限 |
|----------|----------|
| 我参与的项目 | ✅ 完全权限 |
| 我部门的项目 | 👁 列表可见 |
| 其他部门项目 | ❌ 不可见 |
| 敏感项目 | ❌ 完全隐藏 |

#### 【用户代表】#32 回复 #31
基本接受，建议"我部门的项目"默认给只读权限而非仅列表可见

#### 【用户体验设计师】#33 回复 #32
**视图切换设计**：
- Tab切换：我参与的/我部门的/全公司/收藏的
- 默认视图：我参与的
- 权限标识：⭐已参与/👁可查看/🔒需申请

#### 【会议裁判】#34 子主题2小结
**已形成共识**：
1. 权限模型：RBAC+
2. 角色设计：5种角色
3. 默认权限：分层（参与=完全，同部门=只读，其他=不可见）
4. 权限继承：默认继承，可打破
5. 权限申请：一键申请，分级，项目负责人审批
6. 临时授权：支持有效期
7. 审计日志：分层开放，保留1-3年
8. 视图切换：4种视图

**待决事项**：SSO集成优先级、权限审批是否对接外部系统

**用户确认：** ✅ 确认进入子主题3

---

### 子主题3：视图与信息架构（#35-#55）

#### 核心讨论内容

**【会议裁判】#35 开题**
讨论范围：核心视图、我的工作台、筛选与搜索、信息层次、多看板管理

**【用户体验设计师】#36 信息架构设计**
```
整体布局：
┌─────────────────────────────────────────────┐
│ 顶部导航：Logo | 我的工作台 | 项目 | 搜索 | 通知 | 头像 │
├──────────┬──────────────────────────────────┤
│ 侧边栏   │         主内容区                 │
│ · 收藏   │    可切换：看板/列表/日历视图    │
│ · 我的   │                                  │
│ · 项目   │                                  │
│ · 部门   │                                  │
└──────────┴──────────────────────────────────┘
```

**核心视图优先级**：
| 视图 | 优先级 | 阶段 |
|------|--------|------|
| 看板视图 | ⭐⭐⭐ | MVP必备 |
| 列表视图 | ⭐⭐⭐ | MVP必备 |
| 日历视图 | ⭐⭐ | 二期 |
| 甘特图 | ⭐ | 三期（复杂） |

**我的工作台设计**：
```
┌─────────────────────────────────────────────┐
│ 我的工作台                     2024年1月15日 │
├─────────────────────────────────────────────┤
│ 📌 今日待办 (5)                             │
│ 🚫 被阻塞 (2)                               │
│ 👀 我关注的更新 (3)                         │
│ 📤 我指派的任务 (8)                         │
└─────────────────────────────────────────────┘
```

**【用户代表】#37 回复 #36**
对工作台设计非常满意，完美回答三个核心问题：
- 今天干什么 → 今日待办
- 谁在等我 → 被阻塞
- 我等的好了没 → 我关注的更新

补充需求：
1. 逾期任务要特别醒目显示
2. 希望工作台能直接拖拽改状态
3. 需要看"我指派给别人的任务"

**【产品经理】#38 回复 #37**
同意增加"我指派的任务"模块，显示逻辑：优先显示逾期和今日到期，其次阻塞，最后按截止日排序

**【用户体验设计师】#39 逾期任务可视化**
| 逾期天数 | 视觉等级 | 提示方式 |
|----------|----------|----------|
| 1-3天 | 🟡 黄色警告 | 卡片黄色边框 |
| 4-7天 | 🔴 红色警告 | 卡片红色边框+逾期标签 |
| >7天 | 🚨 严重警告 | 红色背景+自动通知上级 |

工作台支持轻量级操作：一键标记完成、快速修改截止日
建议点击任务在侧边抽屉查看，而非跳转新页面

**【技术负责人】#40 侧边抽屉技术实现**
使用Ant Design/Material UI的Drawer组件，成熟方案
数据点击时懒加载，评论分页加载，附件懒加载

**【测试工程师】#41 侧边抽屉测试要点**
功能测试：打开/关闭、编辑保存、状态变更、并发编辑
交互测试：动画流畅度、键盘导航、滚动行为、响应式
边界测试：快速切换、网络慢、编辑中关闭

**【运维工程师】#42 逾期通知定时任务**
每日任务（每天9:00）：扫描逾期任务、分级、生成通知、发送
实时任务：截止前1天提醒、截止当天提醒
可配置：通知等级、通知对象、发送渠道

**【产品经理】#43 逾期通知配置策略**
默认配置：
- 逾期1天：通知负责人
- 逾期3天：通知负责人+项目经理
- 逾期7天：通知负责人+项目经理+部门经理

可配置项：是否启用、通知时间、升级阈值、通知渠道
用户可调：接收提醒、提前天数、免打扰时段

**【用户体验设计师】#45 筛选器设计**
```
┌─────────────────────────────────────────────┐
│ [筛选▼] [负责人▼] [标签▼] [截止日▼] 🔍搜索 │
│ 当前筛选：负责人=张三 ✕  标签=Bug ✕ [清除] │
└─────────────────────────────────────────────┘
```

筛选条件：负责人、标签、优先级、截止日、状态、创建人、是否阻塞、关键词
支持保存筛选器：命名保存、设为默认、分享给项目成员

**【用户代表】#46 筛选器补充需求**
需要支持"排除"筛选（如排除已完成）
需要支持"空值"筛选（如无负责人的任务）

**【技术负责人】#47 排除/空值筛选技术实现**
SQL很简单：NOT IN / IS NULL
前端交互：包含/排除模式切换，特殊选项（无负责人）

**【用户体验设计师】#48 排除筛选交互设计**
```
状态筛选：
[包含 ▼] ← 点击可切换为"排除"
☑ 待办  ☑ 进行中  ☐ 已完成  ☐ 已取消
```
排除模式用红色标识，避免混淆

**【产品经理】#49 多看板管理**
| 看板类型 | 归属 | 用途 |
|----------|------|------|
| 项目看板 | 项目 | 跟踪项目内所有任务 |
| 团队看板 | 部门/团队 | 跟踪团队日常工作 |
| 个人看板 | 个人 | 个人任务管理（私有） |
| 跨项目看板 | 组织 | 聚合多项目关键任务 |

任务主归属一个看板，可引用到其他看板（快捷方式）

**【用户代表】#50 侧边栏优化需求**
项目多时侧边栏很长，需要折叠功能
需要"最近访问"快捷入口

**【用户体验设计师】#51 侧边栏与最近访问**
侧边栏：每个分组可独立折叠，折叠后显示数量，记忆折叠状态
最近访问：顶部导航增加入口，显示最近访问的看板
快捷键：Ctrl+K全局搜索，Ctrl+1~9快速切换收藏

**【技术负责人】#52 最近访问存储方案**
推荐服务端存储，跨设备同步
每用户保留最近50条，30天自动清理
隐私考量：仅本人可见，提供清除功能

**【运维工程师】#53 用户行为数据合规**
建议隐私政策说明：收集哪些、用途、保留期、用户权利
如有GDPR要求：提供数据导出/删除功能

**【产品经理】#54 隐私设置MVP范围**
MVP简化处理：清除最近访问按钮
后续迭代：完整隐私中心、数据导出

**【会议裁判】#55 子主题3小结**
已形成共识10项：
1. 核心视图：看板+列表（MVP），日历（二期），甘特图（三期）
2. 我的工作台：今日待办、被阻塞、关注更新、我指派的
3. 逾期分级显示，可配置自动通知
4. 侧边抽屉快速查看编辑
5. 筛选器：多条件、排除、空值、保存
6. 多看板：项目/团队/个人/跨项目，主归属+引用
7. 侧边栏折叠，显示数量
8. 最近访问：顶部入口，服务端存储
9. 快捷键：Ctrl+K搜索
10. 逾期通知：定时任务，可配置

待决事项：甘特图优先级、隐私设置范围

**用户确认：** ✅ 确认进入子主题4

---

### 子主题4：技术架构与部署

**【会议裁判】#56 开题**
讨论范围：整体架构、实时协作、数据库设计、部署模式、系统集成、性能指标

**【技术负责人】#57 整体架构方案**
架构选型对比：
| 方案 | 优点 | 缺点 |
|------|------|------|
| 单体架构 | 开发快、部署简单 | 扩展性差 |
| 微服务架构 | 独立扩展、故障隔离 | 复杂度高 |
| 模块化单体 | 兼顾简单与可扩展 | 后期拆分有成本 |

推荐：模块化单体→渐进式微服务

技术栈选型：
- 前端：React + TypeScript + Ant Design
- 后端：NestJS 或 Spring Boot（待决策）
- 数据库：PostgreSQL + Redis
- 消息队列：RabbitMQ
- 实时通信：WebSocket

实时协作方案：
- WebSocket + 乐观锁
- 冲突检测：版本号校验
- 冲突处理：回滚+提示用户

**【产品经理】#58 冲突处理用户体验**
分场景处理：
- 拖拽冲突：提示"任务刚被XX移动，是否覆盖？"
- 同时编辑：显示"XX正在编辑"锁
- 字段级冲突：让用户选择保留哪个版本

设计原则：不丢数据、明确告知、给予选择

**【用户代表】#59 实际场景反馈**
多人同时编辑情况偶尔有，不频繁
期望：拖拽实时同步、编辑锁粒度要小
担忧：网络不好时操作会丢失吗？

**【技术负责人】#60 网络异常处理**
处理流程：
1. 用户操作 → 本地乐观更新
2. 发送到服务端
3. 成功 → 确认完成
4. 失败 → 回滚本地状态 + 显示错误提示

具体措施：
- 网络延迟：显示loading状态
- 网络断开：顶部提示"网络已断开"
- 同步失败：回滚+提示
- 离线支持：可选，后期功能

**【运维工程师】#61 WebSocket稳定性保障**
高可用设计：
- 心跳检测：每30秒ping/pong
- 自动重连：断开后指数退避重连
- 多节点部署：至少2个节点
- 消息持久化：重要消息存Redis

容量规划：
| 用户规模 | 连接数 | 服务器配置 |
|----------|--------|------------|
| 50人 | ~100 | 1台2核4G |
| 200人 | ~400 | 2台2核4G |
| 500人 | ~1000 | 3台4核8G |

**【测试工程师】#62 WebSocket测试方案**
功能测试：正常连接、消息推送、断线重连、多设备同步
弱网测试：高延迟、丢包、断网恢复
压力测试：500并发连接，消息延迟<500ms

**【技术负责人】#63 数据库扩展方案**
数据量预估：
- 50人：年10万条，~1GB
- 200人：年40万条，~5GB
- 500人：年100万条，~15GB

扩展策略：
1. 阶段1（50-100人）：单机PostgreSQL
2. 阶段2（100-300人）：主从复制读写分离
3. 阶段3（300-500人）：分库分表
4. 阶段4（500+人）：分布式数据库

缓存策略：
- 用户会话：Redis
- 看板数据：TTL 5分钟
- 任务详情：TTL 1分钟
- 权限数据：TTL 10分钟

**【产品经理】#64 系统集成优先级**
| 优先级 | 集成项 | 阶段 |
|--------|--------|------|
| P0 | SSO单点登录 | MVP（后改为二期） |
| P1 | IM通知推送 | MVP |
| P2 | 日历同步 | 二期 |
| P3 | Git集成 | 二期 |

SSO支持建议：企业微信+钉钉+LDAP

**【用户代表】#65 SSO期望**
使用企业微信
期望：点击应用直接登录，不要再输密码
希望通知能合并，减少打扰

**【用户体验设计师】#66 通知合并设计**
合并策略：
- 同一任务多次更新：合并为一条
- 同一项目多个任务：按项目合并
- 批量操作：合并为一条

合并时间窗口：
- 紧急任务：不合并，立即发送
- 普通任务分配：5分钟
- 评论/更新：10分钟
- 每日摘要：每天早上9点

**【技术负责人】#67 通知合并技术实现**
架构：用户操作→通知事件→消息队列→合并服务→发送服务
使用Redis暂存通知，定时器触发合并发送
工作量：约2-3人周

**【运维工程师】#68 私有化部署方案**
部署架构：
- 负载均衡：Nginx主备
- 应用服务器：集群部署
- 数据层：PostgreSQL主从 + Redis主从

硬件要求：
| 用户规模 | 应用服务器 | 数据库 | 缓存 |
|----------|------------|--------|------|
| 50人 | 1台4核8G | 1台4核8G | 1台2核4G |
| 200人 | 2台4核8G | 主从8核16G | 主从4核8G |
| 500人 | 3台8核16G | 主从16核32G | 主从8核16G |

部署方式建议：
- 50-200人：Docker Compose
- 200人以上：Kubernetes

SLA目标：
- 可用性：99.9%
- 响应时间：<2秒
- 故障恢复：<4小时

**【测试工程师】#69 私有化部署验收测试**
验收测试：环境检查、安装测试、配置测试、功能验证、性能验证
冒烟测试：SSO登录、创建项目看板、任务CRUD、拖拽、通知推送、权限控制、备份恢复
性能验收：50并发登录<3秒、100卡片看板加载<2秒

**【会议裁判】#70 子主题4小结**
已形成共识11项：
1. 架构选型：模块化单体，渐进演进
2. 技术栈：React+TS前端，NestJS/Spring Boot后端，PostgreSQL+Redis
3. 实时协作：WebSocket+乐观锁+冲突检测
4. 冲突处理：分场景，不丢数据、明确告知、给予选择
5. 网络异常：本地乐观更新+失败回滚
6. WebSocket高可用：心跳、自动重连、多节点
7. 数据库扩展：单机→主从→分表
8. SSO优先级：企业微信+钉钉+LDAP（后调整为二期）
9. IM集成：通知推送，支持合并
10. 部署方案：Docker Compose/Kubernetes
11. SLA目标：99.9%可用性，<2秒响应

待决事项：后端技术栈NestJS vs Spring Boot、离线支持优先级

**用户确认：** ✅ 确认进入子主题5

---

### 子主题5：进度追踪与报表

**【会议裁判】#71 开题**
讨论范围：进度统计、仪表盘、报表导出、数据分析、多层视图

**【产品经理】#72 报表需求规划**
用户分层与需求差异：
| 用户层级 | 核心问题 | 需要的数据 |
|----------|----------|------------|
| 一线员工 | 我完成得怎么样？ | 个人任务统计 |
| 项目经理 | 项目进度健康吗？ | 燃尽图、任务分布 |
| 部门经理 | 团队产能如何？ | 吞吐量、成员负载 |
| 高管 | 组织整体如何？ | 全局概览、异常预警 |

核心指标设计：
- 完成率：已完成/总任务数
- 吞吐量：周/月完成任务数
- 周期时间：任务从创建到完成的平均时间
- 阻塞率：被阻塞任务占比
- 逾期率：逾期任务占比
- 负载均衡：成员任务分布

报表类型规划：
| 报表类型 | 优先级 | 阶段 |
|----------|--------|------|
| 项目仪表盘 | P0 | MVP |
| 个人工作统计 | P0 | MVP |
| 燃尽图 | P1 | MVP→二期 |
| 团队报表 | P1 | 二期 |
| 自定义报表 | P2 | 三期 |

**【用户代表】#73 一线用户需求**
真正关心的：
1. 本周完成了多少任务？
2. 有多少任务逾期了？
3. 平均完成时间是多少？

不太关心：复杂图表、团队排名

期望：一键生成周报，方便汇报

**【用户体验设计师】#74 个人工作统计设计**
页面设计：
- 数据卡片：完成数、进行中、逾期数、平均周期
- 环比变化：vs上周对比
- 趋势图：最近4周完成趋势
- 任务列表：本周完成的任务清单

导出功能：
- 格式：图片、Markdown、PDF
- 内容可选：统计数据、任务列表、趋势图
- 一键生成周报

**【产品经理】#75 多层仪表盘设计**
项目仪表盘（项目经理视角）：
- 项目健康度指示
- 任务概览：各状态任务数
- 燃尽图：理想线vs实际线
- 成员负载：各成员任务分布
- 异常预警：阻塞任务、即将逾期、负载过高

管理仪表盘（管理层视角）：
- 全局指标：完成任务、按时完成率、平均周期、阻塞率
- 项目进度对比：各项目完成百分比
- 月度趋势分析

关键设计决策：
- 不显示个人排名（避免内卷）
- 不显示工时（关注产出不关注投入）
- 异常阈值管理员可配置

**【技术负责人】#76 数据计算方案**
计算策略：
- 实时数据：直接查询（任务数量、状态分布）
- 聚合数据：定时计算（趋势图、周期时间）
- 历史数据：预计算存储（月报、季报）

数据模型：
```sql
CREATE TABLE statistics_daily (
    date DATE NOT NULL,
    scope_type VARCHAR(20),
    scope_id INT NOT NULL,
    tasks_created INT,
    tasks_completed INT,
    tasks_overdue INT,
    avg_cycle_time DECIMAL(10,2),
    throughput INT,
    blocked_count INT
);
```

性能优化：Redis缓存、预聚合、汇总表

**【测试工程师】#77 统计数据准确性测试**
测试策略：
- 准确性测试：手工计算对比
- 一致性测试：实时数据与聚合数据对账
- 边界测试：跨天/跨周/跨月数据归属
- 并发测试：高并发下统计是否准确

每日对账机制：定时脚本对比实时计算与聚合数据

**【运维工程师】#78 定时任务可靠性**
调度架构：主备调度器+任务执行器集群
可靠性措施：任务幂等、失败重试、超时控制、执行日志

定时任务清单：
| 任务 | 执行时间 | 超时 |
|------|----------|------|
| 每小时统计 | 每小时第5分钟 | 10分钟 |
| 每日汇总 | 每天00:30 | 30分钟 |
| 逾期扫描 | 每天09:00 | 10分钟 |
| 数据对账 | 每天02:00 | 30分钟 |

**【产品经理】#80 报表订阅与分享**
订阅功能设计：
- 报表类型选择
- 发送频率：每天/每周/每月
- 接收人：自己/项目成员/自定义
- 发送方式：站内/邮件/IM

MVP范围：手动导出（订阅功能二期）

**【用户代表】#81 用户反馈**
手动导出够用，自动订阅是加分项
建议：导出报表带公司Logo更正式

**【用户体验设计师】#82 报表模板设计**
管理员可配置：
- 公司Logo
- 公司名称
- 报表页脚
- 主题色

导出效果：包含Logo、标题、统计数据、任务列表、页脚、生成时间

**【技术负责人】#83 报表导出技术方案**
实现方式：HTML模板 + Puppeteer
支持格式：Markdown、PDF、图片、Excel
性能优化：浏览器池复用、异步生成、模板缓存

生成时间：Markdown<1秒，PDF/图片3-5秒

**【运维工程师】#84 报表服务部署**
方案建议：
- MVP：集成部署（与主应用同容器）
- 后续：按需独立部署

资源限制：Puppeteer并发≤3，单次超时30秒
监控：队列长度、生成时间、失败率

**【会议裁判】#85 子主题5小结**
已形成共识10项：
1. 用户分层：一线/项目经理/部门经理/高管，需求差异大
2. 核心指标：完成率、吞吐量、周期时间、阻塞率、逾期率
3. 个人统计：简洁为主，支持一键周报
4. 项目仪表盘：任务概览、成员负载、异常预警
5. 管理仪表盘：全局指标、项目对比、趋势分析
6. 不显示排名：避免内卷
7. 数据计算：实时+定时聚合+预计算
8. 数据准确性：每日对账机制
9. 报表导出：支持多格式，可配置Logo（后调整为二期）
10. 报表订阅：MVP手动导出，二期自动订阅

待决事项：燃尽图是否MVP必备、报表服务是否独立部署

**用户确认：** ✅ 确认进入第三阶段

---

# 第三阶段：逐一决策

## 待决事项清单

经过第二阶段讨论，共识别出11项待决事项需要逐一决策：

| 序号 | 待决事项 | 来源子主题 |
|------|----------|------------|
| 1 | 软删除数据保留策略 | 核心功能 |
| 2 | 通知偏好设置是否纳入MVP | 核心功能 |
| 3 | 泳道分组是否为核心功能 | 核心功能 |
| 4 | SSO集成优先级排序 | 协作与权限 |
| 5 | 权限审批是否对接企业现有审批系统 | 协作与权限 |
| 6 | 甘特图是否纳入产品路线图 | 视图与信息架构 |
| 7 | 隐私设置模块的范围和优先级 | 视图与信息架构 |
| 8 | 后端技术栈选型：NestJS vs Spring Boot | 技术架构 |
| 9 | 离线支持是否纳入产品路线图 | 技术架构 |
| 10 | 燃尽图是否为MVP必备功能 | 进度追踪 |
| 11 | 报表生成服务是否独立部署 | 进度追踪 |

---

## 决策1：软删除数据保留策略

**【会议裁判】#87**
背景回顾：#15楼产品经理提出任务删除可配置，#17楼测试工程师追问保留策略。

**【产品经理】#88**
保留时长方案对比：

| 方案 | 保留时长 | 优点 | 缺点 |
|------|----------|------|------|
| A. 短期 | 30天 | 存储压力小 | 可能误删无法恢复 |
| B. 中期 | 90天 | 平衡存储与安全 | - |
| C. 长期 | 1年 | 充分保护数据 | 存储成本高 |

倾向方案B（90天），可由管理员配置。

恢复权限设计：
- 普通成员：7天内可恢复自己删除的
- 项目管理员：90天内可恢复本项目内
- 系统管理员：90天内可恢复全部

**【技术负责人】#89**
技术实现简单，通过deleted_at字段+定时清理任务即可。存储影响约100MB，完全可接受。

**✅ 最终决策：采纳建议方案（默认90天，分层恢复权限）**

---

## 决策2：通知偏好设置是否纳入MVP

**【会议裁判】#92**
背景回顾：#19楼运维工程师建议增加通知偏好设置，#3楼用户代表提到通知噪音问题。

**【产品经理】#93**
方案对比：

| 方案 | 内容 | 工作量 | 用户价值 |
|------|------|--------|----------|
| A. 不做 | 系统默认策略 | 0 | 低 |
| B. 最小化 | 仅开/关 | 2人天 | 中 |
| C. 基础版 | 类型开关+方式选择 | 5人天 | 高 |
| D. 完整版 | 全功能 | 10人天 | 很高 |

倾向方案C（基础版）纳入MVP。

**【用户代表】#94**
强烈支持纳入MVP！现有系统每天几十条通知根本看不过来，最后干脆全部忽略。

**【技术负责人】#95**
技术实现简单，5人天可完成。

**✅ 最终决策：纳入MVP（基础版：类型开关+方式选择）**

---

## 决策3：泳道分组是否为核心功能

**【会议裁判】#98**
背景回顾：#12楼用户体验设计师提出泳道分组概念，解决大型组织看板"一锅粥"问题。

**【用户体验设计师】#99**
方案对比：

| 方案 | 说明 | 工作量 |
|------|------|--------|
| A. MVP必备 | 完整泳道分组 | +5人天 |
| B. 二期迭代 | MVP只有基础看板 | 0 |
| C. 简化版MVP | 仅按负责人分组 | +3人天 |

倾向方案C，按负责人分组是站会最刚需的场景。

**【用户代表】#100**
支持方案C！站会时大家轮流说"我今天要做什么"，按人分组直接看自己那一行，特别清晰。

**【技术负责人】#101**
前端分组实现简单，3人天可完成，不增加后端压力。

**✅ 最终决策：简化版纳入MVP（仅按负责人分组）**

---

## 决策4：SSO集成优先级排序

**【会议裁判】#104**
背景回顾：#64楼产品经理提出SSO优先级，#65楼用户代表确认使用企业微信。

**【产品经理】#105**
市场覆盖分析：

| SSO类型 | 覆盖率 | 优先级 |
|---------|--------|--------|
| 企业微信 | 60%+ | P0 |
| 钉钉 | 30%+ | P0 |
| LDAP/AD | 传统企业 | P1 |

方案对比：
- A. 最小化（仅企业微信）：5人天，覆盖60%
- B. 双平台（企业微信+钉钉）：8人天，覆盖90%
- C. 三合一（+LDAP）：12人天，覆盖95%

**【产品经理】#111**
风险提示：如果MVP不做SSO，推广阻力大、管理成本高、用户体验差。

**【技术负责人】#112**
如果MVP不做SSO，后续需处理账号合并问题。

**用户选择方案C（MVP不做SSO）**

⚠️ **风险备注**：已记录推广风险，建议在正式推广前完成SSO集成。

**✅ 最终决策：MVP不做SSO，使用用户名密码登录，SSO放到二期迭代**

---

## 决策5：权限审批是否对接企业现有审批系统

**【会议裁判】#114**
背景回顾：#26楼技术负责人提出三种审批方案。

**【技术负责人】#115**
方案对比：

| 方案 | 说明 | 工作量 |
|------|------|--------|
| A. 简单审批 | 站内通知+一键批准 | 2人天 |
| B. 内置审批引擎 | 自建审批流 | 5人天 |
| C. 对接外部 | 集成企业微信/钉钉审批 | 8人天 |

倾向方案A，结合决策4（MVP不做SSO），对接外部审批也无意义。

**【用户代表】#117**
简单审批完全够用！不需要复杂审批流程。

**✅ 最终决策：MVP采用简单审批，不对接外部系统**

---

## 决策6：甘特图是否纳入产品路线图

**【会议裁判】#120**
背景回顾：#36楼用户体验设计师将甘特图列为三期功能。

**【产品经理】#121**
甘特图价值：项目时间线规划、任务依赖管理、资源调度。
实现复杂度高（15-20人天），建议三期根据用户反馈决定。

**【用户体验设计师】#122**
甘特图功能复杂（时间轴、拖拽、依赖线），建议集成成熟开源组件。

**【用户代表】#123**
作为一线员工不太需要甘特图，但项目经理可能需要。

**【技术负责人】#124**
如果要做，建议使用成熟组件（dhtmlxGantt、Frappe Gantt等）。

**✅ 最终决策：纳入路线图，三期实现（根据用户反馈调整优先级）**

---

## 决策7：隐私设置模块的范围和优先级

**【会议裁判】#127**
背景回顾：#52-54楼讨论了用户行为数据存储和合规问题。

**【产品经理】#128**
方案对比：

| 方案 | MVP范围 | 工作量 |
|------|---------|--------|
| A. 最小化 | 仅隐私政策页面 | 0.5人天 |
| B. 基础版 | +清除最近访问 | 1人天 |
| C. 标准版 | +数据导出/删除 | 5人天 |

倾向方案B，大型组织内部系统合规压力相对较小。

**【运维工程师】#129**
同意方案B，满足基本合规要求。

**用户选择暂不做**

**✅ 最终决策：MVP暂不做隐私设置模块，如有合规需求二期补充**

---

## 决策8：后端技术栈选型（重新讨论）

**【会议裁判】#169**
原决策为"由技术团队自行决定"，用户要求重新讨论明确选型。

**【技术负责人】#170**
核心对比：

| 维度 | NestJS | Spring Boot | 本项目更适合 |
|------|--------|-------------|--------------|
| 开发效率 | 快 | 中等 | NestJS ✅ |
| 前后端统一 | ✅ TypeScript | ❌ | NestJS ✅ |
| WebSocket支持 | 原生优秀 | 支持但稍复杂 | NestJS ✅ |
| 资源占用 | 低(200-500MB) | 高(500MB-1GB) | NestJS ✅ |
| 启动速度 | 快(2-5秒) | 慢(15-30秒) | NestJS ✅ |
| 企业接受度 | 中等 | 很高 | Spring Boot ✅ |
| 招聘难度 | 中等 | 容易 | Spring Boot ✅ |

综合推荐：**NestJS**

理由：
1. 实时协作看板，WebSocket是关键，NestJS原生支持更好
2. MVP需要快速上线，NestJS开发效率更高
3. 私有化部署场景，资源占用小是优势
4. 前后端TypeScript统一，减少上下文切换

**【运维工程师】#171**
从运维角度支持NestJS：镜像更小、启动更快、内存更低。

**【测试工程师】#172**
测试角度两者差异不大，不影响选型。

**【产品经理】#173**
关心招聘问题——NestJS开发者好招吗？

**【技术负责人】#174**
NestJS招聘有一定挑战但不是瓶颈，可招"有TypeScript/Node.js经验"的开发者，前端培训1-2周可上手。

**✅ 最终决策：NestJS (Node.js + TypeScript)——开发效率优先**

---

## 决策9：离线支持是否纳入产品路线图

**【会议裁判】#139**
背景回顾：#60楼技术负责人提到离线支持可作为后期功能。

**【技术负责人】#140**
离线支持级别：
- L1 基础：断网提示+自动重连（MVP已含）
- L2 缓存：离线查看（3人天）
- L3 操作：离线编辑+同步（10人天）
- L4 完整：PWA全套（20人天）

L3以上复杂度高（冲突处理），投入产出比不高。

**【用户代表】#141**
实际场景：办公室WiFi偶尔断几秒，自动重连就够了。完整离线支持不是刚需。

**【产品经理】#142**
竞品参考：Trello有离线但很少人用，Jira无离线用户也能接受。建议暂不纳入路线图。

**✅ 最终决策：暂不纳入路线图（MVP已有基础断网处理）**

---

## 决策10：燃尽图是否为MVP必备功能

**【会议裁判】#145**
背景回顾：#72楼产品经理将燃尽图列为MVP报表功能。

**【产品经理】#146**
燃尽图价值：进度可视化、预测完成时间、识别问题。
实现工作量：约4人天。

方案对比：
- A. MVP必备：+4人天
- B. 二期迭代：0
- C. 简化版MVP：+2人天

倾向方案B，MVP聚焦核心看板功能。

**【用户代表】#147**
作为一线员工对燃尽图没有强需求，但项目经理可能需要。

**【技术负责人】#148**
建议：即使燃尽图放二期，MVP可先做数据采集（0.5人天），这样二期有历史数据可用。

**用户选择方案C（MVP不做任何燃尽图相关工作）**

**✅ 最终决策：二期迭代，MVP不做任何燃尽图相关工作**

---

## 决策11：报表生成服务是否独立部署

**【会议裁判】#151**
背景回顾：#83-84楼讨论了报表导出的技术方案和部署方式。

**【技术负责人】#152**
方案对比：

| 方案 | 说明 | 适用场景 |
|------|------|----------|
| A. 集成部署 | 与主应用同一容器 | 小规模、报表量少 |
| B. 独立部署 | 单独报表服务 | 大规模、报表量大 |
| C. 按需启动 | 生成时启动 | 报表量不稳定 |

倾向方案A（集成部署），通过限流（并发≤3）避免影响主应用。

**【运维工程师】#153**
同意方案A，可通过监控评估是否需要拆分。

**用户选择方案C（MVP不做报表导出功能）**

**✅ 最终决策：MVP不做报表导出功能，二期迭代**

---

# 第四阶段：总结闭环

## 【产品经理】#159 结论草案

发布看板系统评审结论草案，包含：
- 产品定位与核心价值
- MVP功能范围（7大模块）
- 二期/三期功能规划
- 非功能性要求
- 风险提示

## 专家确认

**【用户体验设计师】#160**
确认无异议。功能范围清晰，MVP聚焦核心价值。

**【技术负责人】#161**
确认无异议。架构设计支持后续扩展，数据模型已考虑二期功能。

**【运维工程师】#162**
确认无异议。部署方案满足需求，将准备详细运维文档。

**【测试工程师】#163**
确认无异议。测试策略已确认，将制定详细验收标准。

**【用户代表】#164**
确认无异议。期待MVP尽快上线试用。

---

# 决策结果汇总表

| 序号 | 决策事项 | 最终决策 |
|------|----------|----------|
| 1 | 软删除数据保留策略 | ✅ 默认90天，分层恢复权限 |
| 2 | 通知偏好设置是否纳入MVP | ✅ 纳入MVP（基础版） |
| 3 | 泳道分组是否为核心功能 | ✅ 简化版纳入MVP（仅按负责人分组） |
| 4 | SSO集成优先级 | ⏸️ MVP不做，二期迭代 |
| 5 | 权限审批对接外部系统 | ✅ MVP简单审批，不对接外部 |
| 6 | 甘特图是否纳入路线图 | ✅ 纳入路线图，三期实现 |
| 7 | 隐私设置模块范围 | ⏸️ MVP暂不做 |
| 8 | 后端技术栈选型 | ✅ NestJS (Node.js + TypeScript) |
| 9 | 离线支持是否纳入路线图 | ❌ 暂不纳入路线图 |
| 10 | 燃尽图是否为MVP必备 | ⏸️ 二期迭代，MVP不做 |
| 11 | 报表生成服务部署方式 | ⏸️ MVP不做报表导出功能 |

---

# 会议统计

| 统计项 | 数值 |
|--------|------|
| 总楼层数 | 177楼 |
| 讨论子主题 | 5个 |
| 决策事项 | 11项 |
| 参与角色 | 6位专家 + 裁判 + 记录员 |
| 会议状态 | ✅ 已闭环 |

---

*讨论记录完整版 - 圆桌讨论系统自动生成*
