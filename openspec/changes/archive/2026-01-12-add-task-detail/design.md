## 背景

当前任务模型只有title字段，需要扩展支持描述、截止日期、优先级、负责人等详情字段。这是一个数据模型变更，需要考虑数据库迁移和向后兼容性。

## 目标 / 非目标

**目标：**
- 扩展任务模型支持详情字段
- 提供任务详情编辑界面
- 任务卡片展示关键信息

**非目标：**
- 不实现任务评论功能
- 不实现任务附件功能
- 不实现任务历史记录

## 决策

### 数据模型设计

**Task表新增字段：**

| 字段 | 类型 | 说明 |
|------|------|------|
| description | Text | 任务描述，可为空 |
| due_date | DateTime | 截止日期，可为空 |
| priority | String(10) | 优先级：high/medium/low，默认medium |
| assignee_id | Integer | 负责人ID，外键关联User表，可为空 |

**考虑的替代方案：**
- 使用枚举类型存储优先级 → 选择字符串，更灵活且SQLite兼容性好
- 创建独立的TaskDetail表 → 选择扩展现有表，避免不必要的JOIN

### 前端组件设计

**任务详情弹窗（TaskDetailDialog）：**
- 使用Element Plus的el-dialog组件
- 表单布局：标题、描述（textarea）、截止日期（date-picker）、优先级（select）、负责人（select）
- 实时保存或提交保存 → 选择提交保存，减少API调用

**任务卡片展示：**
- 优先级：左侧彩色条（高-红、中-橙、低-灰）
- 截止日期：底部显示，过期标红
- 负责人：右下角显示用户名首字母头像

### API设计

**更新任务接口：** `PATCH /api/projects/{project_id}/columns/{column_id}/tasks/{task_id}`
- 支持部分更新，只传需要更新的字段

**用户列表接口：** `GET /api/users`
- 返回所有用户的基本信息（id、username）
- 用于负责人下拉选择

## 风险 / 权衡

| 风险 | 缓解措施 |
|------|----------|
| 数据库迁移可能影响现有数据 | 所有新字段设为可空，不影响现有任务 |
| 负责人删除后任务数据不一致 | 外键设置ON DELETE SET NULL |

## 迁移计划

1. 添加新字段到Task模型
2. 执行数据库迁移（alembic或手动SQL）
3. 更新API接口
4. 部署前端更新

**回滚方案：** 新字段均为可空，回滚时前端不展示即可，无需删除数据库字段

## 开放问题

- 无
