# kanban-core Specification

## Purpose
TBD - created by archiving change add-kanban-core. Update Purpose after archive.
## Requirements
### Requirement: 项目管理
系统 MUST 提供项目的创建、查看、编辑、删除功能。

#### Scenario: 创建项目成功
- **WHEN** 用户提供有效的项目名称
- **THEN** 系统创建新项目
- **AND** 自动创建默认列（待办、进行中、已完成）
- **AND** 返回项目信息

#### Scenario: 项目名称为空
- **WHEN** 用户提供空的项目名称
- **THEN** 系统返回错误信息"项目名称不能为空"

#### Scenario: 获取项目列表
- **WHEN** 用户请求项目列表
- **THEN** 系统返回当前用户创建的所有项目

#### Scenario: 获取项目详情
- **WHEN** 用户请求指定项目的详情
- **THEN** 系统返回项目信息、所有列及其任务

#### Scenario: 更新项目
- **WHEN** 用户更新项目名称或描述
- **THEN** 系统保存更新后的项目信息

#### Scenario: 删除项目
- **WHEN** 用户删除项目
- **THEN** 系统删除项目及其所有列和任务
- **AND** 返回成功响应

#### Scenario: 访问他人项目
- **WHEN** 用户尝试访问非自己创建的项目
- **THEN** 系统返回403禁止访问错误

### Requirement: 看板列管理
系统 MUST 提供看板列的创建、查看、编辑、删除、拖拽排序功能。

#### Scenario: 创建列成功
- **WHEN** 用户在项目中创建新列
- **THEN** 系统创建列并设置为最后位置
- **AND** 返回列信息

#### Scenario: 列名称为空
- **WHEN** 用户提供空的列名称
- **THEN** 系统返回错误信息"列名称不能为空"

#### Scenario: 更新列
- **WHEN** 用户更新列名称
- **THEN** 系统保存更新后的列信息

#### Scenario: 删除列
- **WHEN** 用户删除列
- **THEN** 系统删除列及其所有任务
- **AND** 返回成功响应

#### Scenario: 列排序
- **WHEN** 用户拖拽调整列的顺序
- **THEN** 系统更新所有受影响列的位置
- **AND** 返回更新后的列列表

### Requirement: 任务卡片管理
系统 MUST 提供任务卡片的创建、查看、编辑、删除、拖拽排序功能，并支持任务详情管理。

#### Scenario: 创建任务成功
- **WHEN** 用户在列中创建新任务
- **THEN** 系统创建任务并设置为列的最后位置
- **AND** 返回任务信息

#### Scenario: 任务标题为空
- **WHEN** 用户提供空的任务标题
- **THEN** 系统返回错误信息"任务标题不能为空"

#### Scenario: 更新任务基本信息
- **WHEN** 用户更新任务标题
- **THEN** 系统保存更新后的任务信息

#### Scenario: 更新任务详情
- **WHEN** 用户更新任务描述、截止日期、优先级或负责人
- **THEN** 系统保存更新后的任务详情

#### Scenario: 设置任务优先级
- **WHEN** 用户设置任务优先级为高/中/低
- **THEN** 系统保存优先级设置
- **AND** 任务卡片显示对应的优先级标识

#### Scenario: 设置任务截止日期
- **WHEN** 用户设置任务截止日期
- **THEN** 系统保存截止日期
- **AND** 任务卡片显示截止日期

#### Scenario: 指派任务负责人
- **WHEN** 用户从项目成员中选择负责人
- **THEN** 系统保存负责人信息
- **AND** 任务卡片显示负责人

#### Scenario: 删除任务
- **WHEN** 用户删除任务
- **THEN** 系统删除任务
- **AND** 返回成功响应

#### Scenario: 列内拖拽任务
- **WHEN** 用户在同一列内拖拽任务到新位置
- **THEN** 系统更新任务的位置
- **AND** 其他任务位置自动调整

#### Scenario: 跨列拖拽任务
- **WHEN** 用户将任务从一列拖拽到另一列
- **THEN** 系统更新任务所属列和位置
- **AND** 源列和目标列的任务位置自动调整

### Requirement: 前端项目列表页
前端 MUST 提供项目列表页面，展示用户的所有项目。

#### Scenario: 展示项目列表
- **WHEN** 用户访问项目列表页
- **THEN** 页面展示所有项目卡片
- **AND** 每个卡片显示项目名称和描述

#### Scenario: 创建新项目
- **WHEN** 用户点击创建项目按钮
- **THEN** 弹出创建项目对话框
- **AND** 用户填写信息后创建项目

#### Scenario: 进入看板视图
- **WHEN** 用户点击项目卡片
- **THEN** 跳转到该项目的看板视图页

### Requirement: 前端看板视图页
前端 MUST 提供看板视图页面，展示项目的列和任务，支持拖拽交互。

#### Scenario: 展示看板视图
- **WHEN** 用户访问看板视图页
- **THEN** 页面横向展示所有列
- **AND** 每列纵向展示其任务卡片

#### Scenario: 添加新列
- **WHEN** 用户点击添加列按钮
- **THEN** 在看板末尾添加新列

#### Scenario: 添加新任务
- **WHEN** 用户在列中点击添加任务按钮
- **THEN** 在该列末尾添加新任务卡片

#### Scenario: 编辑列名称
- **WHEN** 用户双击列标题
- **THEN** 列标题变为可编辑状态
- **AND** 用户可以修改列名称

#### Scenario: 编辑任务标题
- **WHEN** 用户双击任务卡片
- **THEN** 任务标题变为可编辑状态
- **AND** 用户可以修改任务标题

#### Scenario: 删除列确认
- **WHEN** 用户点击删除列按钮
- **THEN** 弹出确认对话框提示将删除列及其所有任务
- **AND** 用户确认后删除列

#### Scenario: 删除任务
- **WHEN** 用户点击任务的删除按钮
- **THEN** 删除该任务

#### Scenario: 拖拽任务排序
- **WHEN** 用户拖拽任务卡片
- **THEN** 任务可在列内或跨列移动
- **AND** 释放后自动保存新位置

#### Scenario: 拖拽列排序
- **WHEN** 用户拖拽列标题
- **THEN** 列可以左右移动调整顺序
- **AND** 释放后自动保存新顺序

### Requirement: 任务详情弹窗
前端 MUST 提供任务详情弹窗，支持查看和编辑任务的完整信息。

#### Scenario: 打开任务详情
- **WHEN** 用户点击任务卡片
- **THEN** 弹出任务详情弹窗
- **AND** 显示任务的标题、描述、截止日期、优先级、负责人

#### Scenario: 编辑任务描述
- **WHEN** 用户在详情弹窗中编辑任务描述
- **THEN** 系统保存描述内容

#### Scenario: 选择截止日期
- **WHEN** 用户点击截止日期选择器
- **THEN** 显示日期选择组件
- **AND** 用户选择日期后保存

#### Scenario: 选择优先级
- **WHEN** 用户点击优先级选择器
- **THEN** 显示高/中/低三个选项
- **AND** 用户选择后保存

#### Scenario: 选择负责人
- **WHEN** 用户点击负责人选择器
- **THEN** 显示项目成员列表
- **AND** 用户选择后保存

#### Scenario: 关闭详情弹窗
- **WHEN** 用户点击关闭按钮或弹窗外部
- **THEN** 关闭详情弹窗
- **AND** 看板视图刷新显示最新数据

### Requirement: 获取用户列表
系统 MUST 提供获取用户列表的接口，用于任务负责人选择。

#### Scenario: 获取用户列表成功
- **WHEN** 用户请求用户列表
- **THEN** 系统返回所有用户的基本信息（ID、用户名）

#### Scenario: 未登录获取用户列表
- **WHEN** 未登录用户请求用户列表
- **THEN** 系统返回401未授权错误

### Requirement: 项目全局可见
系统 MUST 允许所有已登录用户查看所有项目列表和进入任意项目查看内容。

#### Scenario: 查看所有项目列表
- **WHEN** 用户登录系统后请求项目列表
- **THEN** 系统返回所有项目，不论用户是否为项目创建者

#### Scenario: 进入任意项目查看
- **WHEN** 用户点击任意项目进入详情
- **THEN** 系统允许用户查看该项目的看板、列和任务
- **AND** 用户可以查看但不一定能编辑

### Requirement: 项目编辑权限控制
系统 MUST 基于用户角色控制项目编辑权限。

#### Scenario: 所有者编辑任意项目
- **WHEN** 所有者（超级管理员）编辑任意项目
- **THEN** 系统允许编辑项目信息、管理列和任务

#### Scenario: 管理员编辑任意项目
- **WHEN** 管理员编辑任意项目
- **THEN** 系统允许编辑项目信息、管理列和任务

#### Scenario: 普通用户编辑自己项目
- **WHEN** 普通用户编辑自己创建的项目
- **THEN** 系统允许编辑项目信息、管理列和任务

#### Scenario: 普通用户无法编辑他人项目
- **WHEN** 普通用户尝试编辑非自己创建的项目
- **THEN** 系统拒绝操作并返回 403 错误

### Requirement: 用户角色管理
系统 MUST 支持三种用户角色：所有者、管理员、普通用户。

#### Scenario: 所有者角色
- **WHEN** 用户角色为所有者
- **THEN** 该用户拥有所有权限：编辑所有项目、管理成员权限

#### Scenario: 管理员角色
- **WHEN** 用户角色为管理员
- **THEN** 该用户可以编辑所有项目
- **AND** 该用户不能管理成员权限

#### Scenario: 普通用户角色
- **WHEN** 用户角色为普通用户
- **THEN** 该用户只能编辑自己创建的项目

#### Scenario: 首个用户成为所有者
- **WHEN** 系统中注册第一个用户
- **THEN** 该用户自动成为所有者（超级管理员）

### Requirement: 所有者管理成员权限
系统 MUST 允许所有者管理其他用户的角色。

#### Scenario: 所有者设置管理员
- **WHEN** 所有者将普通用户设置为管理员
- **THEN** 该用户角色变为管理员，可以编辑所有项目

#### Scenario: 所有者取消管理员权限
- **WHEN** 所有者将管理员降级为普通用户
- **THEN** 该用户角色变为普通用户，只能编辑自己的项目

#### Scenario: 管理员不能管理成员权限
- **WHEN** 管理员尝试修改其他用户的角色
- **THEN** 系统拒绝操作并返回 403 错误

